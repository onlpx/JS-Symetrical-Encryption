class SyEnc {constructor(t){this.k=t,this.g=this.s2a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),this.m=this.f(t)}enc(t){"object"!=typeof t&&(t=this.s2a(t));var s=[],h=this.b(t);this.g=h.alphabet;var r=h.rest;for(let t=0;t<this.s2a(this.k).length;t++)if(![...this.g].includes(this.s2a(this.k)[t]))throw new Error("wrong key");var e=[];for(let t=0;t<this.m.length;t++)e.push(this.a(this.m[t]));for(let h=0,r=0;h<t.length;h++,r++){var i=this.g.indexOf(t[h]);h>=32&&(r=0),s.push(e[r][i])}return btoa(this.a2s(s))+(""==r?"":".")+r}dec(t){var s="",h=null;2==t.split(".").length?(s=t.split(".")[1],h=this.s2a(atob(t.split(".")[0]))):h=this.s2a(atob(t));var r=[];this.g=this.r(s).alphabet;for(let t=0;t<this.s2a(this.k).length;t++)if(![...this.g].includes(this.s2a(this.k)[t]))throw new Error("Key contain byte that are not in alphabetBase");var e=[];for(let t=0;t<this.m.length;t++)e.push(this.a(this.m[t]));for(let t=0,s=0;t<h.length;t++,s++){t>=32&&(s=0);var i=e[s].indexOf(h[t]);r.push(this.g[i])}return this.a2s(r)}f(t){var s=[];for(let h=0;s.length<32;h++){for(let h=0;h<t.length;h++)s.push(this.s2a(t)[h]);s=s.reverse()}return s.slice(0,32)}b(t){var s="";for(let h=0;h<t.length;h++)this.g.includes(t[h])||(s+=String.fromCharCode(t[h]),this.g.push(t[h]));return{alphabet:this.g,rest:btoa(s)}}a(t){var s=[...this.g];return s.splice(this.g.indexOf(t),s.length-1).concat(s)}r(t){for(let s=0;s<this.s2a(atob(t)).length;s++)this.g.includes(this.s2a(atob(t))[s])||(this.g=this.g.concat(this.s2a(atob(t))[s]));return{alphabet:this.g,rest:""}}a2s(t){var s="";return t.forEach(t=>{s+=String.fromCharCode(t)}),s}s2a(t){var s=[];for(let h=0;h<t.length;h++)s.push(t.charCodeAt(h));return s}}
// Copyright 2022 Onlp Inc. All rights reserved.